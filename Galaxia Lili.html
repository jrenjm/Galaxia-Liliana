<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Galaxia del Amor</title>
<style>
body,html{margin:0;height:100%;background:#000;overflow:hidden}
canvas{display:block}
.player{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  max-width:600px;
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px;
  border:2px solid #f60;
  border-radius:999px;
  background:0 0;
  box-shadow:0 0 15px #f60,0 0 30px #f30;
  z-index:1000;
  font-family:Arial,sans-serif;
  color:#fff;
  font-size:14px
}
.player button{
  background:0 0;
  border:none;
  color:#fff;
  font-size:22px;
  cursor:pointer;
  filter:drop-shadow(0 0 6px #ff6600);
  transition:transform .2s
}
.player button:hover{
  transform:scale(1.2);
  filter:drop-shadow(0 0 10px #ff3300)
}
.progress{
  flex-grow:1;
  height:14px;
  background:rgba(255,255,255,.12);
  border-radius:999px;
  overflow:hidden;
  cursor:pointer;
  position:relative
}
.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(270deg,#f60,#f30,#f09,#f60);
  background-size:400% 400%;
  border-radius:999px;
  box-shadow:0 0 10px #f60;
  animation:flowing 6s ease infinite
}
@keyframes flowing{
  0%{background-position:0 50%}
  50%{background-position:100% 50%}
  100%{background-position:0 50%}
}
.time{min-width:74px;text-align:right;font-size:12px;color:#fff;text-shadow:0 0 5px #f60}
</style>
</head>
<body>
<canvas id=c></canvas>

<div class="player">
  <button id=play>‚ñ∂Ô∏è</button>
  <div class="progress" id=progress><div class="progress-bar" id=progress-bar></div></div>
  <div class="time" id=time>0:00 / 0:00</div>
</div>

<audio id=audio loop>
  <source src="https://jrenjm.github.io/Galaxia-Liliana/Only.mp3" type="audio/mpeg">
</audio>

<script src="https://cdn.jsdelivr.net/npm/three@0.148.0/build/three.min.js"></script>

<script>
// === Reproductor ===
const audio=document.getElementById("audio"),
playBtn=document.getElementById("play"),
progress=document.getElementById("progress"),
progressBar=document.getElementById("progress-bar"),
timeDisplay=document.getElementById("time");
let isPlaying=!1;
function formatTime(e){if(!isFinite(e))return"0:00";return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}
playBtn.addEventListener("click",async()=>{
  isPlaying?(audio.pause(),playBtn.textContent="‚ñ∂Ô∏è"):(await audio.play(),playBtn.textContent="‚è∏Ô∏è");
  isPlaying=!isPlaying;
});
audio.addEventListener("timeupdate",()=>{
  const e=audio.currentTime/audio.duration*100;
  progressBar.style.width=(isFinite(e)?e:0)+"%";
  timeDisplay.textContent=formatTime(audio.currentTime)+" / "+formatTime(audio.duration);
});
progress.addEventListener("click",e=>{
  const t=progress.getBoundingClientRect(),
  n=(e.clientX-t.left)/t.width;
  isFinite(audio.duration)&&(audio.currentTime=n*audio.duration);
});

// === Escena ===
const canvas=document.getElementById("c"),
renderer=new THREE.WebGLRenderer({canvas,antialias:!0});
renderer.setPixelRatio(Math.min(window.devicePixelRatio||1,2));
renderer.setSize(innerWidth,innerHeight);
const scene=new THREE.Scene(),
camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,.1,5000);
let targetDist=300,currentDist=300,rotX=.2,rotY=0;

// === Fondo espacial ===
const loader=new THREE.TextureLoader;
const nebulaTex=loader.load("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/cube/space/px.jpg");
scene.background=nebulaTex;

// === Estrellas ===
(function(e=2000,t=3000){
  const n=new THREE.BufferGeometry,a=new Float32Array(3*e);
  for(let n=0;n<e;n++){
    const e=t*(.3+.7*Math.random()),r=Math.random()*Math.PI*2,i=Math.acos(2*Math.random()-1);
    a[3*n+0]=e*Math.sin(i)*Math.cos(r),
    a[3*n+1]=e*Math.cos(i),
    a[3*n+2]=e*Math.sin(i)*Math.sin(r)
  }
  n.setAttribute("position",new THREE.BufferAttribute(a,3));
  scene.add(new THREE.Points(n,new THREE.PointsMaterial({size:1.5,color:0xffffff,depthWrite:!1})))
})();



// === Grupo principal (coraz√≥n + texto) ===
const loveGroup = new THREE.Group();
scene.add(loveGroup);

// === Coraz√≥n 3D centrado ===
const heartShape = new THREE.Shape();
heartShape.moveTo(0, 0);
heartShape.bezierCurveTo(0, 3, -3, 3, -3, 0);
heartShape.bezierCurveTo(-3, -3, 0, -3.5, 0, -6);
heartShape.bezierCurveTo(0, -3.5, 3, -3, 3, 0);
heartShape.bezierCurveTo(3, 3, 0, 3, 0, 0);

const extrudeSettings = {
  depth: 2,
  bevelEnabled: true,
  bevelSegments: 3,
  steps: 2,
  bevelSize: 0.4,
  bevelThickness: 0.4
};

const heartGeometry = new THREE.ExtrudeGeometry(heartShape, extrudeSettings);
heartGeometry.center();

const heartMaterial = new THREE.MeshPhongMaterial({
  color: 0xff3366,
  shininess: 300,
  emissive: 0xaa0022,
  specular: 0xffffff,
  transparent: true,
  opacity: 1
});

const heartMesh = new THREE.Mesh(heartGeometry, heartMaterial);
heartMesh.scale.set(6, 6, 6);
loveGroup.add(heartMesh);

// === Texto central ===
function makeCenterTextTexture(e){
  const t = document.createElement("canvas");
  t.width = 4096;   // üîπ ancho grande para evitar recortes
  t.height = 1024;  // üîπ alto para buena resoluci√≥n
  const n = t.getContext("2d");
  n.clearRect(0, 0, t.width, t.height);
  n.font = "bold 500px Arial";  // üîπ texto grande
  n.textAlign = "center";
  n.textBaseline = "middle";
  n.fillStyle = "#ff0033";
  n.shadowColor = "#ff66aa";
  n.shadowBlur = 60;
  n.fillText(e, t.width / 2, t.height / 2);
  return new THREE.CanvasTexture(t);
}

const centerTex = makeCenterTextTexture("TE AMO LILIANA "),
centerMat = new THREE.SpriteMaterial({ map: centerTex, transparent: true, depthTest: false }),
centerSprite = new THREE.Sprite(centerMat);
centerSprite.scale.set(90, 40, 1);   // üîπ tama√±o visible
centerSprite.position.set(0, 40, 0); // üîπ encima del coraz√≥n
loveGroup.add(centerSprite);

// === Luz y anillos ===
scene.add(new THREE.PointLight(0xff8888,1,500));
const ring1=new THREE.Mesh(new THREE.RingGeometry(60,80,128),new THREE.MeshBasicMaterial({color:0xffaa88,transparent:!0,opacity:0.5,side:THREE.DoubleSide}));
const ring2=new THREE.Mesh(new THREE.RingGeometry(85,100,128),new THREE.MeshBasicMaterial({color:0xff8866,transparent:!0,opacity:0.3,side:THREE.DoubleSide}));
ring1.rotation.x=ring2.rotation.x=Math.PI/2;
scene.add(ring1);
scene.add(ring2);

// === Palabras flotantes ===
const WORDS=[],baseWords=[
"üíñ Mi amor","üåû Mi sol","üåé Mi mundo","‚ú® Brillas","‚ù§Ô∏è Te amo","üåå Universo","üëë Reina","üå† Estrella","üí´ Mi cielo","üî• Siempre t√∫","üé∂ Tu risa","ü¶ã Libertad",
"üíé Eres todo","üôè Gracias","üíï Cari√±o","üåπ Amor eterno","ü§ó Abrazos","üå∏ Esperanza","üåà Alegr√≠a","üåü Contigo","üß∏ Ternura","üéÅ Mi raz√≥n","üåô Mi destino",
"üíå Recuerdos","üïäÔ∏è Mi paz","ü™ê Mi universo","üåä Mi calma","üí° Mi luz","üçí Dulzura","ü•∞ Mi vida","üéá Felicidad","üåª Alegr√≠a","üå∫ Mi flor","üíú Eternidad",
"üåü Sue√±os","‚ú® Magia","üéµ Canci√≥n","üî• Pasi√≥n","‚≠ê Mi estrella","üå¥ Mi para√≠so","üåÑ Amanecer","üåÉ Noche contigo","üéâ Mi fiesta","üí´ Inspiraci√≥n",
,"üéÄ Mi ternura","üçÄ Mi fortuna","ü™û Mi princesa"
];
for(let e=0;e<6;e++)WORDS.push(...baseWords);
function makeTextTexture(e,t){
  const n=document.createElement("canvas");
  n.width=512;n.height=128;
  const a=n.getContext("2d");
  a.clearRect(0,0,n.width,n.height);
  a.font="bold 60px Arial";
  a.textAlign="center";
  a.textBaseline="middle";
  a.fillStyle="#fff";
  a.shadowColor=t;
  a.shadowBlur=30;
  a.fillText(e,n.width/2,n.height/2);
  return new THREE.CanvasTexture(n);
}
const COLORS=["#ff66ff","#66ccff","#ffd36b","#ff9966","#8df59a","#ffa0f8","#c6a7ff","#ff4444","#44ff99","#99ccff"],
textGroup=new THREE.Group;
scene.add(textGroup);
for(let e=0;e<WORDS.length;e++){
  const t=makeTextTexture(WORDS[e],COLORS[e%COLORS.length]),
  n=new THREE.SpriteMaterial({map:t,transparent:!0}),
  a=new THREE.Sprite(n);
  a.scale.set(50,16,1);
  const r=Math.acos(2*Math.random()-1),
  i=Math.random()*Math.PI*2,
  o=150+120*Math.random();
  a.position.set(o*Math.sin(r)*Math.cos(i),o*Math.cos(r),o*Math.sin(r)*Math.sin(i));
  a.userData={phi:r,theta:i,radius:o,speed:.001+.001*Math.random()};
  textGroup.add(a);
}

// === Fotos flotantes ===
const imageGroup=new THREE.Group();
scene.add(imageGroup);
const imgLoader=new THREE.TextureLoader();
for(let i=1;i<=50;i++){
  const path=`https://jrenjm.github.io/Galaxia-Liliana/f${i}.jpg`;
  const img=new Image();
  img.onload=()=>{
    const texture=imgLoader.load(path);
    const mat=new THREE.SpriteMaterial({map:texture,transparent:true});
    const sprite=new THREE.Sprite(mat);
    sprite.scale.set(40,40,1);
    const phi=Math.acos(2*Math.random()-1),
          theta=Math.random()*Math.PI*2,
          radius=180+120*Math.random();
    sprite.position.set(
      radius*Math.sin(phi)*Math.cos(theta),
      radius*Math.cos(phi),
      radius*Math.sin(phi)*Math.sin(theta)
    );
    sprite.userData={phi,theta,radius,speed:0.001+0.001*Math.random()};
    imageGroup.add(sprite);
  };
  img.src=path;
}

// === Movimiento del mouse ===
let dragging=false,lastX=0,lastY=0;
canvas.addEventListener("mousedown",e=>{
  dragging=true;lastX=e.clientX;lastY=e.clientY;
});
canvas.addEventListener("mouseup",()=>dragging=false);
canvas.addEventListener("mousemove",e=>{
  if(!dragging)return;
  const dx=e.clientX-lastX,dy=e.clientY-lastY;
  rotY-=dx*0.005;
  rotX-=dy*0.005;
  rotX=Math.max(-Math.PI/2,Math.min(Math.PI/2,rotX));
  lastX=e.clientX;lastY=e.clientY;
});
canvas.addEventListener("wheel",e=>{
  targetDist+=e.deltaY*0.3;
  targetDist=Math.max(100,Math.min(1000,targetDist));
});
// üíì Animaci√≥n de latido sincronizado (coraz√≥n + texto)
let heartPulse = 0;

function animateHeart() {
  heartPulse += 0.05;

  // Efecto de latido del coraz√≥n
  if (typeof heartMesh !== "undefined" && heartMesh) {
    const heartScale = 6 + Math.sin(heartPulse) * 0.4;
    heartMesh.scale.set(heartScale, heartScale, heartScale);
  }

  // Efecto sincronizado del texto
  if (typeof centerSprite !== "undefined" && centerSprite) {
    const textScaleX = 90 + Math.sin(heartPulse) * 6;
    const textScaleY = 40 + Math.sin(heartPulse) * 3;
    centerSprite.scale.set(textScaleX, textScaleY, 1);
    centerSprite.material.opacity = 0.85 + Math.sin(heartPulse) * 0.15;
  }

  requestAnimationFrame(animateHeart);
}
animateHeart();

// === Animaci√≥n ===
let t=0;
function tick(){
  requestAnimationFrame(tick);
  t+=.01;
  ring1.rotation.z+=.002;
  ring2.rotation.z-=.0015;
  textGroup.children.forEach(e=>{
    e.material.opacity=.8+.2*Math.sin(2*t);
    e.userData.theta+=e.userData.speed;
    e.position.x=e.userData.radius*Math.sin(e.userData.phi)*Math.cos(e.userData.theta);
    e.position.z=e.userData.radius*Math.sin(e.userData.phi)*Math.sin(e.userData.theta);
  });
  imageGroup.children.forEach(e=>{
    e.material.opacity=.9+.1*Math.sin(2*t);
    e.userData.theta+=e.userData.speed;
    e.position.x=e.userData.radius*Math.sin(e.userData.phi)*Math.cos(e.userData.theta);
    e.position.z=e.userData.radius*Math.sin(e.userData.phi)*Math.sin(e.userData.theta);
  });
  currentDist += 0.06 * (targetDist - currentDist);
const n = Math.cos(rotX),
      a = Math.sin(rotX),
      r = Math.cos(rotY),
      i = Math.sin(rotY);

// üåÄ Movimiento de la c√°mara (alrededor del centro)
camera.position.set(currentDist * i * n, currentDist * a, currentDist * r * n);
camera.lookAt(0, 0, 0);

// üíû Hace que el coraz√≥n + texto siempre miren a la c√°mara (como uno solo)
loveGroup.lookAt(camera.position);


renderer.render(scene, camera);
}
tick();
</script>
</body>
</html>
